!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done)&&(n.push(c.value),!t||n.length!==t);i=!0);}catch(a){o=!0,r=a}finally{try{i||null==l.return||l.return()}finally{if(o)throw r}}return n}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{CgPW:function(n,i,r){"use strict";r.r(i),r.d(i,"EndpointRulesModule",(function(){return _t}));var l,a,u,b=r("2kYt"),f=r("sEIs"),p=r("EM62"),h=r("ZF+8"),g=function e(){d(this,e)},m=r("8j5Y"),v=r("C05f"),S=function(){function e(t){d(this,e),this.Item=t,this._showDetails=!1,this.ShowDetailsSubject$=new v.a(!1),this.ShowDetails$=this.ShowDetailsSubject$.asObservable()}return s(e,[{key:"ShowDetails",set:function(e){this._showDetails=e,this.ShowDetailsSubject$.next(this._showDetails)},get:function(){return this._showDetails}}]),e}(),O=r("oqI+"),y=function(){function e(){d(this,e),this.AllItems=[],this.Selected=[]}return s(e,[{key:"Single",get:function(){var e;return 1===(null===(e=this.Selected)||void 0===e?void 0:e.length)?this.Selected[0]:null}},{key:"IsFirst",get:function(){return this.Single?this.AllItems[0].Id===this.Single.Id:null}},{key:"IsLast",get:function(){return this.Single?this.AllItems[this.AllItems.length-1].Id===this.Single.Id:null}}]),e}(),x=r("vobO"),k=r("YtkY"),T=r("J+dc"),z=r("kZjU"),C=r("D57K"),w=r("XzLU"),I=((a=function(e){o(n,e);var t=c(n);function n(){return d(this,n),t.call(this)}return n}(w.a)).\u0275fac=function(e){return new(e||a)},a.\u0275prov=p.Jb({token:a,factory:a.\u0275fac,providedIn:"root"}),a=Object(C.a)([Object(w.e)({name:"endpoint-rules",idKey:"Id"})],a)),M=((l=function(e){o(n,e);var t=c(n);function n(e){var i;return d(this,n),(i=t.call(this,e)).store=e,i}return n}(w.c)).\u0275fac=function(e){return new(e||l)(p.Xb(I))},l.\u0275prov=p.Jb({token:l,factory:l.\u0275fac,providedIn:"root"}),l),P=new x.e({"Content-Type":"application/json-patch+json",Accept:"application/json"}),R=((u=function(){function e(t,n,i,o){var r=this;d(this,e),this.http=t,this.message=n,this.endpointRulesStore=i,this.endpointRulesQuery=o,this.RulesOrder={},this.typings$=new v.a([]),this.Subscribe(),this.message.RunOnEveryReconnect((function(){return r.GetAllRules().subscribe()})),this.message.RunOnEveryReconnect((function(){return r.GetTypings()}))}return s(e,[{key:"Subscribe",value:function(){var e=this;this.message.Stream("MiddlerRule.Subscribe").pipe(Object(m.a)((function(t){switch(t.Action){case"Created":e.endpointRulesStore.add(t.Payload);break;case"Updated":if(t.MetaData.UpdateOrder){var n=t.Payload;Object.keys(n).forEach((function(t){e.endpointRulesStore.update(t,{Order:n[t]})}))}else e.endpointRulesStore.update(t.Payload.Id,(function(e){return t.Payload}));break;case"Deleted":e.endpointRulesStore.update(t.Payload,(function(e){return Object.assign(Object.assign({},e),{Deleted:!0})})),e.endpointRulesStore.remove(t.Payload)}}))).subscribe()}},{key:"ReLoadRules",value:function(){var e=this;this.http.get("/api/endpoint-rules").pipe(Object(m.a)((function(t){return e.endpointRulesStore.set(t)}))).subscribe()}},{key:"GetAllRules",value:function(e){var t=this;return!e&&this.endpointRulesQuery.getHasCache()||this.ReLoadRules(),this.endpointRulesQuery.selectAll().pipe(Object(k.a)((function(e){return e.sort(t.SortRules)})))}},{key:"GetRule",value:function(e){return this.http.get("/api/endpoint-rules/"+e)}},{key:"Add",value:function(e){return this.http.post("/api/endpoint-rules",e)}},{key:"Remove",value:function(e){return this.http.delete("/api/endpoint-rules/"+e)}},{key:"Update",value:function(e,t){return this.http.put("/api/endpoint-rules/"+e,t)}},{key:"UpdateAction",value:function(e){return this.http.put("/api/endpoint-action/"+e.Id,e)}},{key:"SortRules",value:function(e,t){return e.Order>t.Order?1:e.Order<t.Order?-1:0}},{key:"GetNextLastOrder",value:function(){var e=this.endpointRulesQuery.getAll();return e&&0!==e.length?Math.trunc(Math.max.apply(Math,t(e.map((function(e){return e.Order}))))+10):10}},{key:"UpdateRuleOrder",value:function(e,t){var n={};n[e.Id]=t,this.http.post("/api/endpoint-rules/order",n,{headers:P}).subscribe()}},{key:"SetRuleEnabled",value:function(e,t){this.http.put("/api/endpoint-rules/".concat(e.Id,"/enabled/").concat(t),null,{headers:P}).subscribe()}},{key:"GetTypings",value:function(){var e=this;this.message.Invoke("MiddlerRule.GetTypings").pipe(Object(T.a)(1),Object(m.a)((function(t){var n=t.map((function(e){return new z.b(e.Key,e.Value,!1)}));e.typings$.next(n)}))).subscribe()}}]),e}()).\u0275fac=function(e){return new(e||u)(p.Xb(x.c),p.Xb(h.d),p.Xb(I),p.Xb(M))},u.\u0275prov=p.Jb({token:u,factory:u.\u0275fac,providedIn:"root"}),u),A=r("5m6l"),_=function e(){d(this,e),this.Enabled=!0},G=function e(){d(this,e),this.RewriteTo=""},E=function(e){o(n,e);var t=c(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).ActionType="UrlRewrite",e.Parameters=new G,e.Terminating=!1,e}return n}(_),N=r("nIj0"),H=r("l+TO"),D=r("duTG"),U=r("ZTwM"),L=r("1spV"),j=r("B0q8"),F=r("JbzU"),B=r("XS/p");function V(e,t){1&e&&(p.Tb(0,"div"),p.Gc(1,"Action"),p.Sb())}var K,J=["*"],Q=((K=function(){function e(){d(this,e),this.ok=new p.n,this.save=new p.n,this.cancel=new p.n,this.ctrls=!1}return s(e,[{key:"keydown",value:function(e){e.stopPropagation();var t=String.fromCharCode(e.which).toLowerCase();e.ctrlKey&&"s"===t&&(e.preventDefault(),this.ctrls||(this.ctrls=!0,this.save.next()))}},{key:"keyup",value:function(e){e.stopPropagation();var t=String.fromCharCode(e.which).toLowerCase();e.ctrlKey&&"s"===t&&(e.preventDefault(),this.ctrls=!1)}}]),e}()).\u0275fac=function(e){return new(e||K)},K.\u0275cmp=p.Hb({type:K,selectors:[["action-basic-modal"]],hostAttrs:[1,"flex-grow-column","action-basic-modal"],hostBindings:function(e,t){1&e&&p.bc("keydown",(function(e){return t.keydown(e)}),!1,p.vc)("keyup",(function(e){return t.keyup(e)}),!1,p.vc)},inputs:{form:"form"},outputs:{ok:"ok",save:"save",cancel:"cancel"},ngContentSelectors:J,decls:25,vars:4,consts:[[1,"modal-header",2,"padding","10px !important","display","flex","margin-bottom","1px"],[2,"font-size","2em","font-weight","bold","line-height","1.4285em","color","whitesmoke","margin","auto"],["dbPortal","ActionModalHeader-Left",1,"Irgendwos"],["left","dbPortal"],[4,"ngIf"],[2,"flex-grow","1"],["dbPortal","ActionModalHeader-Right"],[1,"modal-content"],[1,"modal-footer",2,"margin-bottom","0px","margin-top","1px","background","#292f3b","padding","2px"],["nz-button","","nzType","default",1,"secondary",3,"click"],["nz-button","","nzType","primary",3,"disabled","click"],["nz-button","","nzType","primary","nz-dropdown","",3,"nzDropdownMenu","disabled"],["nz-icon","","nzType","ellipsis"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"]],template:function(e,t){if(1&e&&(p.kc(),p.Tb(0,"div",0),p.Tb(1,"div",1),p.Pb(2,2,3),p.Ec(4,V,2,0,"div",4),p.Sb(),p.Ob(5,"div",5),p.Tb(6,"div"),p.Pb(7,6),p.Sb(),p.Sb(),p.Tb(8,"div",7),p.jc(9),p.Sb(),p.Tb(10,"div",8),p.Tb(11,"button",9),p.bc("click",(function(){return t.cancel.next()})),p.Gc(12,"Cancel"),p.Sb(),p.Ob(13,"div",5),p.Tb(14,"nz-button-group"),p.Tb(15,"button",10),p.bc("click",(function(){return t.ok.next()})),p.Gc(16,"Submit & Close"),p.Sb(),p.Tb(17,"button",11),p.Ob(18,"i",12),p.Sb(),p.Sb(),p.Sb(),p.Tb(19,"nz-dropdown-menu",null,13),p.Tb(21,"ul",14),p.Tb(22,"li",15),p.bc("click",(function(){return t.save.next()})),p.Tb(23,"a"),p.Gc(24,"Save Action without close"),p.Sb(),p.Sb(),p.Sb(),p.Sb()),2&e){var n=p.tc(3),i=p.tc(20);p.zb(4),p.lc("ngIf",!n.hasSource),p.zb(11),p.lc("disabled",!t.form.valid),p.zb(2),p.lc("nzDropdownMenu",i)("disabled",!t.form.valid)}},directives:[H.d,b.o,D.a,U.a,L.a,D.b,j.d,j.b,F.a,j.e,B.c,B.e],styles:["[_nghost-%COMP%]{box-shadow:0 0 1px 2px #dedddd;max-width:100%;max-height:100%;background-color:#dedddd}",".modal-header[_ngcontent-%COMP%]{background-color:#292f3b!important}.modal-header[_ngcontent-%COMP%], .modal-header[_ngcontent-%COMP%]   .ui.huge.header[_ngcontent-%COMP%]{color:#fff!important}.modal-content[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{border:none!important;display:flex}.modal-content[_ngcontent-%COMP%]{flex-grow:1;max-width:100%;max-height:100%}.flex-grow-column[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], action-basic-modal[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], action-basic-modal[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ng-component[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}action-basic-modal[_ngcontent-%COMP%]   div[name][_ngcontent-%COMP%]{min-height:1.28571429em}.action-basic-modal[_ngcontent-%COMP%]{box-shadow:0 0 3px 1px #bfbfbf!important}"]}),K),q=r("PlhU"),X=r("Mr8s"),W=r("mybp");function Y(e,t){1&e&&p.Gc(0," Url - Rewrite ")}var Z,ee=((Z=function(){function e(t,n){d(this,e),this.fb=t,this.context=n}return s(e,[{key:"ngOnInit",value:function(){this.form=this.fb.group({RewriteTo:[]}),this.form.patchValue(this.context.data.Parameters)}},{key:"ok",value:function(){this.context.invoke("OK",this.form.value)}},{key:"cancel",value:function(){this.context.handle.Close()}}]),e}()).\u0275fac=function(e){return new(e||Z)(p.Nb(N.e),p.Nb(A.d))},Z.\u0275cmp=p.Hb({type:Z,selectors:[["ng-component"]],decls:7,vars:2,consts:[[3,"form","ok","cancel"],["nz-form","",2,"width","100%",3,"formGroup"],["nzRequired","","nzFor","RewriteTo"],["nz-input","","formControlName","RewriteTo","id","RewriteTo",2,"width","100%"],["dbPortalTemplate","ActionModalHeader-Left"]],template:function(e,t){1&e&&(p.Tb(0,"action-basic-modal",0),p.bc("ok",(function(){return t.ok()}))("cancel",(function(){return t.cancel()})),p.Tb(1,"form",1),p.Tb(2,"nz-form-label",2),p.Gc(3,"RewriteTo"),p.Sb(),p.Tb(4,"nz-form-control"),p.Ob(5,"input",3),p.Sb(),p.Ec(6,Y,1,0,"ng-template",4),p.Sb(),p.Sb()),2&e&&(p.lc("form",t.form),p.zb(1),p.lc("formGroup",t.form))},directives:[Q,N.r,N.n,q.b,N.h,X.a,q.d,q.a,W.b,N.d,N.m,N.g,H.e],styles:[""]}),Z),te=function e(){d(this,e),this.RedirectTo="",this.Permanent=!1,this.PreserveMethod=!0},ne=function(e){o(n,e);var t=c(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).ActionType="UrlRedirect",e.Parameters=new te,e.Terminating=!0,e}return n}(_),ie=r("MaY1");function oe(e,t){1&e&&p.Gc(0," Url - Redirect ")}var re,ce=((re=function(){function e(t,n){d(this,e),this.fb=t,this.context=n}return s(e,[{key:"ngOnInit",value:function(){this.form=this.fb.group({RedirectTo:[],Permanent:[],PreserveMethod:[]}),this.form.patchValue(this.context.data.Parameters)}},{key:"ok",value:function(){this.context.invoke("OK",this.form.value)}},{key:"cancel",value:function(){this.context.handle.Close()}}]),e}()).\u0275fac=function(e){return new(e||re)(p.Nb(N.e),p.Nb(A.d))},re.\u0275cmp=p.Hb({type:re,selectors:[["ng-component"]],decls:14,vars:2,consts:[[3,"form","ok","cancel"],["nz-form","",2,"width","100%",3,"formGroup"],["nzRequired","","nzFor","RedirectTo"],["nz-input","","formControlName","RedirectTo","id","RedirectTo",2,"width","100%"],[2,"display","flex","flex-direction","row"],[1,"field"],["nz-checkbox","","formControlName","PreserveMethod"],["nz-checkbox","","formControlName","Permanent"],["dbPortalTemplate","ActionModalHeader-Left"]],template:function(e,t){1&e&&(p.Tb(0,"action-basic-modal",0),p.bc("ok",(function(){return t.ok()}))("cancel",(function(){return t.cancel()})),p.Tb(1,"form",1),p.Tb(2,"nz-form-label",2),p.Gc(3,"RedirectTo"),p.Sb(),p.Tb(4,"nz-form-control"),p.Ob(5,"input",3),p.Sb(),p.Tb(6,"div",4),p.Tb(7,"div",5),p.Tb(8,"label",6),p.Gc(9,"PreserveMethod"),p.Sb(),p.Sb(),p.Tb(10,"div",5),p.Tb(11,"label",7),p.Gc(12,"Permanent"),p.Sb(),p.Sb(),p.Sb(),p.Ec(13,oe,1,0,"ng-template",8),p.Sb(),p.Sb()),2&e&&(p.lc("form",t.form),p.zb(1),p.lc("formGroup",t.form))},directives:[Q,N.r,N.n,q.b,N.h,X.a,q.d,q.a,W.b,N.d,N.m,N.g,ie.a,H.e],styles:[".field[_ngcontent-%COMP%]{padding-top:5px}"]}),re),le=function e(){d(this,e),this.Language="Typescript"},ae=function(e){o(n,e);var t=c(n);function n(){var e;return d(this,n),(e=t.apply(this,arguments)).ActionType="Script",e.Parameters=new le,e.Terminating=!0,e}return n}(_),ue=r("ox+w");function se(e,t){1&e&&p.Gc(0," Script ")}function de(e,t){1&e&&(p.Tb(0,"div",6),p.Tb(1,"div",7),p.Tb(2,"nz-select",8),p.Ob(3,"nz-option",9),p.Ob(4,"nz-option",10),p.Ob(5,"nz-option",11),p.Sb(),p.Sb(),p.Sb())}var be,fe,pe=function(){return{noLib:!0}},he=((fe=function(){function e(t,n,i){d(this,e),this.fb=t,this.context=n,this.rulesService=i,this.typings$=this.rulesService.typings$.pipe(Object(m.a)((function(e){return console.log(e)})))}return s(e,[{key:"ngOnInit",value:function(){this.form=this.fb.group({Language:[],SourceCode:[]}),this.context.data.Parameters.Language||(this.context.data.Parameters.Language="Typescript"),this.form.patchValue(this.context.data.Parameters)}},{key:"initRestrictionsAccordion",value:function(e){$(e.nativeElement).accordion()}},{key:"ok",value:function(){this.context.invoke("OK",this.form.value)}},{key:"save",value:function(){console.log("save modal"),this.context.invoke("Save",this.form.value)}},{key:"cancel",value:function(){this.context.handle.Close()}}]),e}()).\u0275fac=function(e){return new(e||fe)(p.Nb(N.e),p.Nb(A.d),p.Nb(R))},fe.\u0275cmp=p.Hb({type:fe,selectors:[["ng-component"]],decls:7,vars:8,consts:[[3,"form","ok","cancel","save"],["nz-form","",1,"flex-grow-column",2,"width","100%",3,"formGroup"],[1,"field","flex-grow-column"],["formControlName","SourceCode",2,"max-width","100%","max-height","100%","position","relative",3,"language","typings","tsOptions"],["dbPortalTemplate","ActionModalHeader-Left"],["dbPortalTemplate","ActionModalHeader-Right"],[1,"fields"],[2,"width","180px"],["formControlName","Language",2,"width","100%"],["nzLabel","Typescript","nzValue","Typescript"],["nzLabel","Javascript","nzValue","Javascript"],["nzLabel","Powershell","nzValue","Powershell"]],template:function(e,t){1&e&&(p.Tb(0,"action-basic-modal",0),p.bc("ok",(function(){return t.ok()}))("cancel",(function(){return t.cancel()}))("save",(function(){return t.save()})),p.Tb(1,"form",1),p.Tb(2,"div",2),p.Ob(3,"db-editor",3),p.fc(4,"async"),p.Sb(),p.Ec(5,se,1,0,"ng-template",4),p.Ec(6,de,6,0,"ng-template",5),p.Sb(),p.Sb()),2&e&&(p.lc("form",t.form),p.zb(1),p.lc("formGroup",t.form),p.zb(2),p.lc("language",t.form.value.Language)("typings",p.gc(4,5,t.typings$))("tsOptions",p.nc(7,pe)))},directives:[Q,N.r,N.n,q.b,N.h,z.a,N.m,N.g,H.e,ue.b,ue.a],pipes:[b.b],styles:[""]}),fe),ge=((be=function(){function e(t,n){d(this,e),this.modal=t,this.componentFactoryResolver=n}return s(e,[{key:"GetIcon",value:function(e){switch(e.ActionType){case"UrlRedirect":return"rollback";case"UrlRewrite":return"edit";case"Proxy":return"fa#random";case"Script":return"code"}return"hat wizard"}},{key:"GetModal",value:function(e){switch(e.toLowerCase()){case"urlredirect":return this.modal.FromComponent(ce).SetModalOptions({componentFactoryResolver:this.componentFactoryResolver,overlayConfig:{width:"50%",maxWidth:"500px"}}).CloseOnOutsideClick();case"urlrewrite":return this.modal.FromComponent(ee).SetModalOptions({componentFactoryResolver:this.componentFactoryResolver,overlayConfig:{width:"50%",maxWidth:"500px"}}).CloseOnOutsideClick();case"script":return this.modal.FromComponent(he).SetModalOptions({componentFactoryResolver:this.componentFactoryResolver,overlayConfig:{width:"80%",height:"90%"}}).CloseOnOutsideClick()}}}]),e}()).\u0275fac=function(e){return new(e||be)(p.Xb(A.b),p.Xb(p.j))},be.\u0275prov=p.Jb({token:be,factory:be.\u0275fac,providedIn:"root"}),be),me=r("2rm1"),ve=r("t8yx"),Se=["contextMenu"],Oe=["addRuleTemplate"];function ye(e,t){1&e&&(p.Tb(0,"div",8),p.Tb(1,"div",9),p.Gc(2,"Currently there is nothing..."),p.Sb(),p.Tb(3,"p"),p.Gc(4,"Use the ContextMenu to create your first rule!"),p.Sb(),p.Sb())}function xe(e,t){if(1&e&&(p.Tb(0,"span",21),p.Ob(1,"db-icon",22),p.Sb()),2&e){var n=t.$implicit,i=p.ec(2);p.lc("nzTooltipTitle",n.ActionType),p.zb(1),p.lc("icon",i.GetIcon(n))}}function ke(e,t){1&e&&p.Ob(0,"div",23)}function Te(e,t){if(1&e){var n=p.Ub();p.Tb(0,"div",10),p.bc("click",(function(e){p.wc(n);var i=t.$implicit;return p.ec().clickAction(e,i)}))("contextmenu",(function(e){p.wc(n);var i=t.$implicit,o=p.ec(),r=p.tc(11);return o.openItemContextMenu(e,r,i)}))("dblclick",(function(){p.wc(n);var e=t.$implicit;return p.ec().editRule(e.Item.Id)})),p.Tb(1,"div",11),p.Tb(2,"div",12),p.Ob(3,"db-icon",13),p.Sb(),p.Tb(4,"div",14),p.Tb(5,"div",15),p.Gc(6),p.Sb(),p.Tb(7,"div"),p.Gc(8),p.Sb(),p.Sb(),p.Tb(9,"div",16),p.Tb(10,"div"),p.Gc(11),p.Sb(),p.Tb(12,"div"),p.Gc(13),p.Sb(),p.Sb(),p.Tb(14,"div",17),p.Tb(15,"div",18),p.Tb(16,"div"),p.Gc(17),p.Sb(),p.Ec(18,xe,2,2,"span",19),p.Sb(),p.Ec(19,ke,1,0,"div",20),p.Sb(),p.Sb(),p.Sb()}if(2&e){var i=t.$implicit,o=p.ec();p.Fb("selected",i.Selected)("disabled",!i.Item.Enabled),p.zb(6),p.Hc(i.Item.Name),p.zb(2),p.Hc(i.Item.Path),p.zb(3),p.Hc(i.Item.Scheme),p.zb(2),p.Hc(i.Item.Hostname),p.zb(4),p.Ic(" ",(null==i.Item.Actions?null:i.Item.Actions.length)||0," Actions "),p.zb(1),p.lc("ngForOf",i.Item.Actions),p.zb(1),p.lc("ngIf",o.IsRuleTerminating(i.Item))}}function ze(e,t){if(1&e){var n=p.Ub();p.Tb(0,"ul",24),p.Tb(1,"li",25),p.Tb(2,"ul",26),p.Tb(3,"li",27),p.bc("click",(function(){return p.wc(n),p.ec().CreateRuleOnTop()})),p.Ob(4,"db-icon",28),p.Gc(5," Top "),p.Sb(),p.Tb(6,"li",27),p.bc("click",(function(){return p.wc(n),p.ec().CreateRuleOnBottom()})),p.Ob(7,"db-icon",29),p.Gc(8," Bottom "),p.Sb(),p.Sb(),p.Sb(),p.Sb()}}function Ce(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",27),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().SetRuleEnabled(e.Single,!0)})),p.Ob(1,"db-icon",34),p.Gc(2," Enable "),p.Sb()}}function we(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",27),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().SetRuleEnabled(e.Single,!1)})),p.Ob(1,"db-icon",35),p.Gc(2," Disable "),p.Sb()}}function Ie(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",25),p.Tb(1,"ul",26),p.Tb(2,"li",27),p.bc("click",(function(){return p.wc(n),p.ec(2).CreateRuleOnTop()})),p.Ob(3,"db-icon",28),p.Gc(4," Top "),p.Sb(),p.Tb(5,"li",27),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateRuleBefore(e.Single)})),p.Ob(6,"db-icon",36),p.Gc(7," Before "),p.Sb(),p.Tb(8,"li",27),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateRuleAfter(e.Single)})),p.Ob(9,"db-icon",37),p.Gc(10," After "),p.Sb(),p.Tb(11,"li",27),p.bc("click",(function(){return p.wc(n),p.ec(2).CreateRuleOnBottom()})),p.Ob(12,"db-icon",29),p.Gc(13," Bottom "),p.Sb(),p.Sb(),p.Sb()}}function Me(e,t){if(1&e){var n=p.Ub();p.Tb(0,"ul",24),p.Ec(1,Ce,3,0,"li",30),p.Ec(2,we,3,0,"li",30),p.Ec(3,Ie,14,0,"li",31),p.Ob(4,"li",32),p.Tb(5,"li",27),p.bc("click",(function(){p.wc(n);var e=t.$implicit;return p.ec().RemoveRules(e.Selected)})),p.Ob(6,"db-icon",33),p.Gc(7," Remove "),p.Sb(),p.Sb()}if(2&e){var i=t.$implicit;p.zb(1),p.lc("ngIf",!1===(null==i.Single?null:i.Single.Enabled)),p.zb(1),p.lc("ngIf",!0===(null==i.Single?null:i.Single.Enabled)),p.zb(1),p.lc("ngIf",i.Single)}}var Pe,Re,Ae=function(){return[]},_e=((Re=function(){function e(t,n,i,o,r,c,l,a){d(this,e),this.rulesService=t,this.cref=n,this.overlay=i,this.viewContainerRef=o,this.router=r,this.route=c,this.actionHelper=l,this.endpointRulesQuery=a,this._rules=[],this.rulesSubject$=new v.a(this._rules),this.rules$=this.rulesSubject$.asObservable(),this.rulesChanged=new p.n,this.selected=[],this.registered=[],this.onTouched=function(){}}return s(e,[{key:"ngOnInit",value:function(){var e=this;this.rulesService.GetAllRules().pipe(Object(m.a)((function(t){e.rules=t}))).subscribe()}},{key:"ngAfterViewInit",value:function(){}},{key:"clickAction",value:function(e,t){e.ctrlKey?t.Selected=!t.Selected:this._rules=this._rules.map((function(e){return e.Selected=e==t,e}))}},{key:"openOuterContextMenu",value:function(e,t){var n;e.stopPropagation(),null===(n=this.ContextMenu)||void 0===n||n.Close(),this.ContextMenu=this.overlay.OpenContextMenu(e,t,this.viewContainerRef,null)}},{key:"openItemContextMenu",value:function(e,t,n){var i;e.stopPropagation();var o=this._rules.filter((function(e){return e.Selected}));0!=o.length&&o.includes(n)||(this._rules=this._rules.map((function(e){return e.Selected=e==n,e}))),null===(i=this.ContextMenu)||void 0===i||i.Close(),this.ContextMenu=this.overlay.OpenContextMenu(e,t,this.viewContainerRef,this.BuildContext())}},{key:"DeSelectAll",value:function(){console.log("Deselect"),this._rules=this._rules.map((function(e){return e.Selected=!1,e}))}},{key:"SetRuleEnabled",value:function(e,t){var n;null===(n=this.ContextMenu)||void 0===n||n.Close(),this.rulesService.SetRuleEnabled(e,t)}},{key:"GetActionByIndex",value:function(e){return this.rules[e]}},{key:"GetActionById",value:function(e){return this.rules.find((function(t){return t.Id===e}))}},{key:"ClearSelection",value:function(){this.selected=[],this.cref.markForCheck()}},{key:"BuildContext",value:function(){var e=new y;return e.AllItems=this.rules,e.Selected=this._rules.filter((function(e){return e.Selected})).map((function(e){return e.Item})),e}},{key:"IsRuleTerminating",value:function(e){return!!e.Actions&&-1!=e.Actions.findIndex((function(e){return e.Enabled&&e.Terminating}))}},{key:"initContextMenu",value:function(e){}},{key:"CreateRuleOnTop",value:function(){var e=new g;e.Enabled=!1,e.Order=this.rules&&0!=this.rules.length?this.rules[0].Order/2:10,this.rulesService.Add(e).subscribe(),this.ContextMenu.Close()}},{key:"CreateRuleBefore",value:function(e){var t=this.rules.findIndex((function(t){return t.Order===e.Order})),n=new g;n.Enabled=!1,n.Order=0==t?e.Order/2:e.Order-(e.Order-this.rules[t-1].Order)/2,console.log(n),this.rulesService.Add(n).subscribe(),this.ContextMenu.Close()}},{key:"CreateRuleAfter",value:function(e){var t=this.rules.findIndex((function(t){return t.Order===e.Order})),n=new g;n.Enabled=!1,n.Order=t==this.rules.length-1?this.rulesService.GetNextLastOrder():e.Order+(this.rules[t+1].Order-e.Order)/2,console.log(n),this.rulesService.Add(n).subscribe(),this.ContextMenu.Close()}},{key:"CreateRuleOnBottom",value:function(){var e=new g;e.Enabled=!1,e.Order=this.rulesService.GetNextLastOrder(),this.rulesService.Add(e).subscribe(),this.ContextMenu.Close()}},{key:"RemoveRules",value:function(e){var t=this;e.forEach((function(e){return t.rulesService.Remove(e.Id).subscribe()})),this.ContextMenu.Close()}},{key:"editRule",value:function(e){this.router.navigate([e],{relativeTo:this.route})}},{key:"calculateRuleOrder",value:function(e){if(0===this.rules.length)return 10;if(0===e)return this.rules[0].Order/2;if(e>=this.rules.length)return this.rulesService.GetNextLastOrder();var t=this.rules[e-1].Order;return(this.rules[e].Order-t)/2+t}},{key:"drop",value:function(e){if(e.previousContainer===e.container){var t=this.endpointRulesQuery.getAll().sort(this.rulesService.SortRules),n=t[e.previousIndex],i=null;if(e.previousIndex<e.currentIndex?i="forward":e.previousIndex>e.currentIndex&&(i="back"),!i)return;if("forward"===i)if(e.currentIndex===t.length-1)this.rulesService.UpdateRuleOrder(n,this.rulesService.GetNextLastOrder());else{var o=t[e.currentIndex];this.rulesService.UpdateRuleOrder(n,(t[e.currentIndex+1].Order-o.Order)/2+o.Order)}else if("back"===i)if(0===e.currentIndex)this.rulesService.UpdateRuleOrder(n,t[0].Order/2);else{var r=t[e.currentIndex-1];this.rulesService.UpdateRuleOrder(n,(t[e.currentIndex].Order-r.Order)/2+r.Order)}Object(O.e)(t,e.previousIndex,e.currentIndex)}else{var c=new g;c.Enabled=!1,console.log(e),c.Order=this.calculateRuleOrder(e.currentIndex),this.rulesService.Add(c).subscribe()}}},{key:"GetIcon",value:function(e){return this.actionHelper.GetIcon(e)}},{key:"prepareIcon",value:function(e){if(!e)return null;if(e.startsWith("fa#")){var t={type:"fa",icon:null};return e=e.substring(3),t.icon=e.includes("|")?e.split("|"):e,t}return{type:"ant",icon:e}}},{key:"propagateChange",value:function(e){this.rulesChanged.next(e),this.registered.forEach((function(t){t(e)}))}},{key:"writeValue",value:function(e){this.rules=e}},{key:"registerOnChange",value:function(e){-1===this.registered.indexOf(e)&&this.registered.push(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){throw new Error("Method not implemented.")}},{key:"rules",set:function(e){var t=this;this._rules=(e||[]).map((function(e){var n=t._rules.find((function(t){return t.Item.Id===e.Id}));return n?(n.Item=e,n):new S(e)})),this.rulesSubject$.next(this._rules)},get:function(){return this._rules.map((function(e){return e.Item}))}}]),e}()).\u0275fac=function(e){return new(e||Re)(p.Nb(R),p.Nb(p.h),p.Nb(A.c),p.Nb(p.P),p.Nb(f.i),p.Nb(f.a),p.Nb(ge),p.Nb(M))},Re.\u0275cmp=p.Hb({type:Re,selectors:[["enpoint-rules-list"]],viewQuery:function(e,t){var n;1&e&&(p.Kc(Se,!0),p.Kc(Oe,!0)),2&e&&(p.sc(n=p.cc())&&(t.contextMenu=n.first),p.sc(n=p.cc())&&(t.addRuleTemplate=n.first))},inputs:{rules:"rules"},outputs:{rulesChanged:"rulesChanged"},decls:12,vars:7,consts:[["cdkDropList","",1,"outer",2,"flex-grow","1","height","100%",3,"contextmenu"],["nullList","cdkDropList"],["cdkDropList","",1,"",2,"padding","2px","margin-top","8px","max-height","calc(100% - 30px)","overflow-y","auto",3,"cdkDropListDropped"],["rulesList","cdkDropList"],["style","text-align: center; font-size: 1.3em; font-weight: bold; color: #525e7678; line-height: 1.4em; line-height: 2em; margin: 0px 10px;",4,"ngIf"],["class","rule-item","cdkDrag","","cdkDragLockAxis","y",3,"selected","disabled","click","contextmenu","dblclick",4,"ngFor","ngForOf"],["outerContextMenu",""],["itemContextMenu",""],[2,"text-align","center","font-size","1.3em","font-weight","bold","color","#525e7678","line-height","1.4em","line-height","2em","margin","0px 10px"],[2,"font-size","1.5em"],["cdkDrag","","cdkDragLockAxis","y",1,"rule-item",3,"click","contextmenu","dblclick"],[2,"display","flex","min-height","60px"],["cdkDragHandle","",1,"dragHandle",2,"padding","10px 0px 0px 5px"],["icon","fa#ellipsis-v",2,"width","1.18em","margin","0 .25rem 0 0","font-size","1.2em"],[2,"padding","5px","flex-grow","1"],[2,"font-size","large","font-weight","bold","color","#292f3b"],[2,"padding","5px","min-width","200px","max-width","200px"],[2,"min-width","200px","max-width","200px","display","flex"],[2,"flex-grow","1","padding","5px"],["nz-tooltip","",3,"nzTooltipTitle",4,"ngFor","ngForOf"],["class","terminate-indicator","nz-tooltip","","nzTooltipTitle","Stop processing further Rules",4,"ngIf"],["nz-tooltip","",3,"nzTooltipTitle"],[3,"icon"],["nz-tooltip","","nzTooltipTitle","Stop processing further Rules",1,"terminate-indicator"],["nz-menu","","nzMode","vertical",1,"context-menu"],["nz-submenu","","nzTitle","Add Rule","nzIcon","menu-unfold"],[1,"context-menu"],["nz-menu-item","",3,"click"],["icon","double-left","rotate","90"],["icon","double-right","rotate","90"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-submenu","","nzTitle","Add Rule","nzIcon","menu-unfold",4,"ngIf"],["nz-menu-divider",""],["icon","delete"],["icon","fa#toggle-on"],["icon","fa#toggle-off"],["icon","up"],["icon","down"]],template:function(e,t){if(1&e){var n=p.Ub();p.Tb(0,"div",0,1),p.bc("contextmenu",(function(e){p.wc(n);var i=p.tc(9);return t.openOuterContextMenu(e,i)})),p.Tb(2,"div",2,3),p.bc("cdkDropListDropped",(function(e){return t.drop(e)})),p.Ec(4,ye,5,0,"div",4),p.fc(5,"async"),p.Ec(6,Te,20,11,"div",5),p.fc(7,"async"),p.Sb(),p.Sb(),p.Ec(8,ze,9,0,"ng-template",null,6,p.Fc),p.Ec(10,Me,8,3,"ng-template",null,7,p.Fc)}2&e&&(p.zb(4),p.lc("ngIf",0===(p.gc(5,2,t.rules$)||p.nc(6,Ae)).length),p.zb(2),p.lc("ngForOf",p.gc(7,4,t.rules$)))},directives:[O.c,b.o,b.n,O.a,O.b,me.c,ve.d,B.c,L.a,B.g,B.e,B.d],pipes:[b.b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1}.rule-item[_ngcontent-%COMP%]{margin-bottom:10px!important;border-radius:0!important;box-shadow:0 0 3px 1px #cecece;background-color:#fff}.rule-item.disabled[_ngcontent-%COMP%]{opacity:.6;box-shadow:none;background-color:#e2e2e2}.rule-item[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{border-right:1px solid #fff}.rule-item[_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:#525e76;color:#fff}.rule-item.selected[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{background-color:#292f3b;color:#fff}.rule-item[_ngcontent-%COMP%]:hover{background-color:#b2b7c2}.new-rule.ui.button[_ngcontent-%COMP%]{margin:0}.options[_ngcontent-%COMP%]{background-color:grey;height:50px}.list-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background-color:inherit!important}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:hover{background-color:inherit}.dragHandle[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.list-item[_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:#e0e1e2}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{cursor:inherit}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:inherit}.list-item.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%], .new-rule.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%]{border-radius:0!important;background-color:#2f2f2f;color:#f5f5f5}.outer.cdk-drop-list-dragging[_ngcontent-%COMP%] > .new-rule.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%]{display:none}.context-menu[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:0!important}.anticon.disabled[_ngcontent-%COMP%]{color:#ccc}.terminate-indicator[_ngcontent-%COMP%]{width:8px;background-color:#525e76;border-left:1px solid #fff}.action-item.disabled[_ngcontent-%COMP%]   .terminate-indicator[_ngcontent-%COMP%]{background-color:inherit}.action-item[_ngcontent-%COMP%]:hover   .terminate-indicator[_ngcontent-%COMP%]{background-color:#525e76;color:#fff}  .ant-divider-horizontal.ant-divider-with-text-center:after,   .ant-divider-horizontal.ant-divider-with-text-center:before{border-top:1px solid #525e76!important}"],changeDetection:0}),Re),Ge=((Pe=function e(t){d(this,e),this.uiService=t,t.Set((function(e){e.Header.Title="Endpoint Rules",e.Content.Scrollable=!1,e.Header.Icon="fa#stream"}))}).\u0275fac=function(e){return new(e||Pe)(p.Nb(h.a))},Pe.\u0275cmp=p.Hb({type:Pe,selectors:[["ng-component"]],decls:2,vars:0,consts:[[2,"display","flex","flex-direction","column","flex-grow","1"]],template:function(e,t){1&e&&(p.Tb(0,"div",0),p.Ob(1,"enpoint-rules-list"),p.Sb())},directives:[_e],styles:[""]}),Pe),Ee=r("HM3f"),Ne=r("3lSR"),He=r("t2t5"),De=r("INpK"),Ue=r("vkL3"),$e=["urlredirect"],Le=["urlrewrite"],je=["script"];function Fe(e,t){if(1&e&&(p.Tb(0,"div"),p.Gc(1),p.Sb(),p.Tb(2,"div"),p.Gc(3),p.Sb(),p.Tb(4,"div"),p.Gc(5),p.Sb()),2&e){var n=p.ec();p.zb(1),p.Ic(" Redirect to ",n.action.Parameters.RedirectTo," "),p.zb(2),p.Ic(" Permanent: ",n.action.Parameters.Permanent," "),p.zb(2),p.Ic(" PreserveMethod: ",n.action.Parameters.PreserveMethod," ")}}function Be(e,t){if(1&e&&(p.Tb(0,"div"),p.Gc(1),p.Sb()),2&e){var n=p.ec();p.zb(1),p.Ic(" Rewrite to ",n.action.Parameters.RewriteTo," ")}}function Ve(e,t){if(1&e&&(p.Tb(0,"div"),p.Gc(1),p.Sb()),2&e){var n=p.ec();p.zb(1),p.Ic(" ",n.action.Parameters.Language," ")}}var Ke,Je=((Ke=function(){function e(){d(this,e)}return s(e,[{key:"ngOnInit",value:function(){this.template=this.determineTemplate()}},{key:"determineTemplate",value:function(){switch(this.action.ActionType){case"UrlRedirect":return this.UrlRedirect;case"UrlRewrite":return this.UrlRewrite;case"Script":return this.Script}}}]),e}()).\u0275fac=function(e){return new(e||Ke)},Ke.\u0275cmp=p.Hb({type:Ke,selectors:[["action-list-details"]],viewQuery:function(e,t){var n;1&e&&(p.Bc($e,!0),p.Bc(Le,!0),p.Bc(je,!0)),2&e&&(p.sc(n=p.cc())&&(t.UrlRedirect=n.first),p.sc(n=p.cc())&&(t.UrlRewrite=n.first),p.sc(n=p.cc())&&(t.Script=n.first))},inputs:{action:"action"},decls:8,vars:1,consts:[[2,"font-size","x-small"],[3,"ngTemplateOutlet"],["urlredirect",""],["urlrewrite",""],["script",""]],template:function(e,t){1&e&&(p.Tb(0,"div",0),p.Pb(1,1),p.Sb(),p.Ec(2,Fe,6,3,"ng-template",null,2,p.Fc),p.Ec(4,Be,2,1,"ng-template",null,3,p.Fc),p.Ec(6,Ve,2,1,"ng-template",null,4,p.Fc)),2&e&&(p.zb(1),p.lc("ngTemplateOutlet",t.template))},directives:[b.t],styles:[""]}),Ke),Qe=r("Pq5H"),qe=r("fWDI");function Xe(e,t){1&e&&(p.Tb(0,"div",8),p.Tb(1,"div",9),p.Gc(2,"Currently there is nothing..."),p.Sb(),p.Tb(3,"p"),p.Gc(4,"Use the ContextMenu to create your first action!"),p.Sb(),p.Sb())}function We(e,t){if(1&e&&p.Ob(0,"i",23),2&e){var n=p.ec().$implicit;p.lc("nzType",n.icon)}}function Ye(e,t){if(1&e&&p.Ob(0,"fa-icon",24),2&e){var n=p.ec().$implicit;p.lc("icon",n.icon)}}function Ze(e,t){if(1&e&&(p.Tb(0,"div",20),p.Ec(1,We,1,1,"i",21),p.Ec(2,Ye,1,1,"fa-icon",22),p.Sb()),2&e){var n=t.$implicit;p.zb(1),p.lc("ngIf","ant"==n.type),p.zb(1),p.lc("ngIf","fa"==n.type)}}function et(e,t){if(1&e&&p.Ob(0,"div",25),2&e){var n=p.ec(),i=n.$implicit,o=n.index,r=p.ec();p.lc("nzTooltipTitle",r.GetTerminateStatusText(i,o))}}function tt(e,t){if(1&e&&(p.Rb(0),p.Ob(1,"nz-divider",26),p.Qb()),2&e){var n=t.$implicit;p.zb(1),p.lc("nzText",n)}}function nt(e,t){if(1&e){var n=p.Ub();p.Rb(0),p.Tb(1,"div",10),p.Tb(2,"div",11),p.bc("click",(function(e){p.wc(n);var i=t.$implicit;return p.ec().ClickAction(e,i)}))("dblclick",(function(){p.wc(n);var e=t.$implicit;return p.ec().openModal(e)}))("contextmenu",(function(e){p.wc(n);var i=t.$implicit,o=p.ec(),r=p.tc(11);return o.openItemContextMenu(e,r,i)})),p.Tb(3,"div",12),p.Tb(4,"div",13),p.Ec(5,Ze,3,2,"div",14),p.Sb(),p.Tb(6,"div",15),p.Tb(7,"div",16),p.Gc(8),p.Sb(),p.Ob(9,"action-list-details",17),p.Sb(),p.Ec(10,et,1,1,"div",18),p.Sb(),p.Sb(),p.Ec(11,tt,2,1,"ng-container",19),p.Sb(),p.Qb()}if(2&e){var i=t.$implicit,o=t.index,r=p.ec();p.zb(2),p.Fb("selected",r.IsActionSelected(i))("disabled",!i.Enabled)("afterTerminate",r.IsAfterTerminate(o)),p.zb(3),p.lc("ngIf",r.prepareIcon(r.GetIcon(i))),p.zb(3),p.Ic("",i.ActionType," "),p.zb(1),p.lc("action",i),p.zb(1),p.lc("ngIf",i.Terminating),p.zb(1),p.lc("ngIf",r.GetTerminateStatus(i,o))}}function it(e,t){if(1&e){var n=p.Ub();p.Tb(0,"ul",27),p.Tb(1,"li",28),p.Tb(2,"ul",29),p.Tb(3,"li",30),p.bc("click",(function(){return p.wc(n),p.ec().CreateAction("UrlRedirect","bottom")})),p.Ob(4,"i",31),p.Gc(5," UrlRedirect "),p.Sb(),p.Tb(6,"li",30),p.bc("click",(function(){return p.wc(n),p.ec().CreateAction("UrlRewrite","bottom")})),p.Ob(7,"i",32),p.Gc(8," UrlRewrite "),p.Sb(),p.Tb(9,"li",30),p.bc("click",(function(){return p.wc(n),p.ec().CreateAction("Script","bottom")})),p.Ob(10,"i",33),p.Gc(11," Script "),p.Sb(),p.Sb(),p.Sb(),p.Sb()}}var ot=function(){return["fas","toggle-on"]};function rt(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().SetActionEnabled(e.Single,!0)})),p.Ob(1,"fa-icon",40),p.Gc(2," Enable "),p.Sb()}2&e&&(p.zb(1),p.lc("icon",p.nc(1,ot)))}var ct=function(){return["fas","toggle-off"]};function lt(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().SetActionEnabled(e.Single,!1)})),p.Ob(1,"fa-icon",40),p.Gc(2," Disable "),p.Sb()}2&e&&(p.zb(1),p.lc("icon",p.nc(1,ct)))}function at(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().openModal(e.Single)})),p.Ob(1,"i",41),p.Gc(2," Edit "),p.Sb()}}function ut(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec(2).$implicit;return p.ec().SetActionTerminate(e.Single,!0)})),p.Ob(1,"db-icon",43),p.Gc(2," Stop processing after Action "),p.Sb()}}function st(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec(2).$implicit;return p.ec().SetActionTerminate(e.Single,!1)})),p.Ob(1,"db-icon",44),p.Gc(2," Continue processing after Action "),p.Sb()}}function dt(e,t){if(1&e&&(p.Tb(0,"li",42),p.Tb(1,"ul",29),p.Ec(2,ut,3,0,"li",34),p.Ec(3,st,3,0,"li",34),p.Sb(),p.Sb()),2&e){var n=p.ec().$implicit;p.zb(2),p.lc("ngIf",!1===(null==n.Single?null:n.Single.Terminating)),p.zb(1),p.lc("ngIf",!0===(null==n.Single?null:n.Single.Terminating))}}function bt(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",45),p.Tb(1,"ul",29),p.Tb(2,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("UrlRedirect","before",e.Single)})),p.Ob(3,"i",31),p.Gc(4," UrlRedirect "),p.Sb(),p.Tb(5,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("UrlRewrite","before",e.Single)})),p.Ob(6,"i",32),p.Gc(7," UrlRewrite "),p.Sb(),p.Tb(8,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("Script","before",e.Single)})),p.Ob(9,"i",33),p.Gc(10," Script "),p.Sb(),p.Sb(),p.Sb()}}function ft(e,t){if(1&e){var n=p.Ub();p.Tb(0,"li",46),p.Tb(1,"ul",29),p.Tb(2,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("UrlRedirect","after",e.Single)})),p.Ob(3,"i",31),p.Gc(4," UrlRedirect "),p.Sb(),p.Tb(5,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("UrlRewrite","after",e.Single)})),p.Ob(6,"i",32),p.Gc(7," UrlRewrite "),p.Sb(),p.Tb(8,"li",30),p.bc("click",(function(){p.wc(n);var e=p.ec().$implicit;return p.ec().CreateAction("Script","after",e.Single)})),p.Ob(9,"i",33),p.Gc(10," Script "),p.Sb(),p.Sb(),p.Sb()}}function pt(e,t){if(1&e){var n=p.Ub();p.Tb(0,"ul",27),p.Ec(1,rt,3,2,"li",34),p.Ec(2,lt,3,2,"li",34),p.Ec(3,at,3,0,"li",34),p.Ec(4,dt,4,2,"li",35),p.Ec(5,bt,11,0,"li",36),p.Ec(6,ft,11,0,"li",37),p.Ob(7,"li",38),p.Tb(8,"li",30),p.bc("click",(function(){p.wc(n);var e=t.$implicit;return p.ec().RemoveActions(e.Selected)})),p.Ob(9,"i",39),p.Gc(10," Remove "),p.Sb(),p.Sb()}if(2&e){var i=t.$implicit;p.zb(1),p.lc("ngIf",!1===(null==i.Single?null:i.Single.Enabled)),p.zb(1),p.lc("ngIf",!0===(null==i.Single?null:i.Single.Enabled)),p.zb(1),p.lc("ngIf",i.Single),p.zb(1),p.lc("ngIf",i.Single),p.zb(1),p.lc("ngIf",i.Single),p.zb(1),p.lc("ngIf",i.Single)}}var ht,gt=function(){return[]},mt=((ht=function(){function e(t,n,i,o,r,c,l,a){var u=this;d(this,e),this.uiService=t,this.modal=n,this.overlay=i,this.viewContainerRef=o,this.cref=r,this.componentFactoryResolver=c,this.actionHelper=l,this.rulesService=a,this.terminateActionIndex=-1,this.actionsSubject$=new v.a(null),this.actions$=this.actionsSubject$.asObservable().pipe(Object(m.a)((function(e){u.terminateActionIndex=e.findIndex((function(e){return e.Enabled&&e.Terminating}))}))),this.actionsChange=new p.n,this.selectedActions=[],this.registered=[],this.onTouched=function(){}}return s(e,[{key:"ngOnInit",value:function(){}},{key:"IsActionSelected",value:function(e){return this.selectedActions.includes(e.Id)}},{key:"setActionSelected",value:function(e,n){this.selectedActions=n?t(new Set([].concat(t(this.selectedActions),[e.Id]))):this.selectedActions.filter((function(t){return t!=e.Id}))}},{key:"GetSelectedActions",value:function(){var e=this;return this.actions.filter((function(t){return e.selectedActions.includes(t.Id)}))}},{key:"ClickAction",value:function(e,t){var n;if(e.stopPropagation(),null===(n=this.ContextMenu)||void 0===n||n.Close(),e.ctrlKey){var i=this.IsActionSelected(t);this.setActionSelected(t,!i)}else this.selectedActions=[],this.setActionSelected(t,!0)}},{key:"OpenOuterContextMenu",value:function(e,t){var n;e.stopPropagation(),this.selectedActions=[],null===(n=this.ContextMenu)||void 0===n||n.Close(),this.ContextMenu=this.overlay.OpenContextMenu(e,t,this.viewContainerRef,null)}},{key:"ClickOutside",value:function(){this.selectedActions=[]}},{key:"openItemContextMenu",value:function(e,t,n){var i;if(e.stopPropagation(),0==this.selectedActions.length||!this.IsActionSelected(n))if(e.ctrlKey){var o=this.IsActionSelected(n);this.setActionSelected(n,!o)}else this.selectedActions=[],this.setActionSelected(n,!0);null===(i=this.ContextMenu)||void 0===i||i.Close(),this.ContextMenu=this.overlay.OpenContextMenu(e,t,this.viewContainerRef,this.BuildContext())}},{key:"BuildContext",value:function(){var e=this,t=new y;return t.AllItems=this.actions,t.Selected=this.actions.filter((function(t){return e.selectedActions.includes(t.Id)})),t}},{key:"GetIcon",value:function(e){return this.actionHelper.GetIcon(e)}},{key:"prepareIcon",value:function(e){if(!e)return null;if(e.startsWith("fa#")){var t={type:"fa",icon:null};return e=e.substring(3),t.icon=e.includes("|")?e.split("|"):e,t}return{type:"ant",icon:e}}},{key:"CreateAction",value:function(e,n,i){var o=new _;switch(e.toLowerCase()){case"urlredirect":o=new ne;break;case"urlrewrite":o=new E;break;case"script":o=new ae}o.Order=this.CalculateOrder(n,i),o.Id=this.getNewActionsId().toString(),this.actions=[].concat(t(this.actions),[o]),this.propagateChange(this.actions)}},{key:"getNewActionsId",value:function(){var e=this.actions.map((function(e){return/^(\-|\+)?([0-9]+|Infinity)$/.test(t=e.Id)?Number(t):NaN;var t})).filter((function(e){return!Number.isNaN(e)})).sort((function(e,t){return t-e}));return e&&e.length>0?e[0]+1:0}},{key:"GetNextLastOrder",value:function(){if(!this.actions||0===this.actions.length)return 10;var e=Math.trunc(Math.max.apply(Math,t(this.actions.map((function(e){return e.Order}))))+10);return console.log("NEXT",e),e}},{key:"CalculateOrder",value:function(e,t){var n,i=-1;switch(t&&(i=null===(n=this.actions)||void 0===n?void 0:n.findIndex((function(e){return e.Order===t.Order}))),e){case"top":return this.actions&&0!=this.actions.length?this.actions[0].Order/2:10;case"before":return 0==i?t.Order/2:t.Order-(t.Order-this.actions[i-1].Order)/2;case"after":return i==this.actions.length-1?this.GetNextLastOrder():t.Order+(this.actions[i+1].Order-t.Order)/2;case"bottom":return this.GetNextLastOrder()}}},{key:"SetActionEnabled",value:function(e,t){this.actions=this.actions.map((function(n){return n==e&&(n.Enabled=t),n})),this.propagateChange(this.actions)}},{key:"SetActionTerminate",value:function(e,t){this.actions=this.actions.map((function(n){return n==e&&(n.Terminating=t),n})),this.propagateChange(this.actions)}},{key:"RemoveActions",value:function(e){var t,n=e.map((function(e){return e.Id}));this.actions=this.actions.filter((function(e){return!n.includes(e.Id)})),this.propagateChange(this.actions),null===(t=this.ContextMenu)||void 0===t||t.Close()}},{key:"drop",value:function(e){console.log(e);var n=this.actions[e.previousIndex],i=null;if(e.previousIndex<e.currentIndex?i="forward":e.previousIndex>e.currentIndex&&(i="back"),i){if(console.log(i,this.actions.length),"forward"===i)if(e.currentIndex===this.actions.length-1)console.log("-- 1 --"),n.Order=this.GetNextLastOrder();else{console.log("-- 2 --");var o=this.actions[e.currentIndex];n.Order=(this.actions[e.currentIndex+1].Order-o.Order)/2+o.Order}else if("back"===i)if(0===e.currentIndex)console.log("-- 3 --"),n.Order=this.actions[0].Order/2;else{console.log("-- 4 --");var r=this.actions[e.currentIndex-1];n.Order=(this.actions[e.currentIndex].Order-r.Order)/2+r.Order}Object(O.e)(this.actions,e.previousIndex,e.currentIndex),this.actions=t(this.actions),this.propagateChange(this.actions)}}},{key:"GetTerminateStatus",value:function(e,t){return e.Enabled?this.IsAfterTerminate(t)?null:this.GetTerminateStatusText(e,t):null}},{key:"GetTerminateStatusText",value:function(e,t){var n=this.IsLastExecuted(t);return!e.Terminating&&n?"Continue with next Endpoint Rule":e.Terminating&&n?"Stop processing further Endpoint Rules":e.Terminating&&!n?"Stop processing further Actions / Endpoint Rules":void 0}},{key:"IsAfterTerminate",value:function(e){return-1!=this.terminateActionIndex&&e>this.terminateActionIndex}},{key:"IsLastExecuted",value:function(e){return 0==this.actions.filter((function(t,n){return t.Enabled&&n>e})).length}},{key:"openModal",value:function(e){var n,i=this;switch(null===(n=this.ContextMenu)||void 0===n||n.Close(),Object.assign({},e),e.ActionType){case"UrlRedirect":this.actionHelper.GetModal("UrlRedirect").SetData(e).AddEventHandler("OK",(function(n){e.Parameters=n.payload,i.actions=t(i.actions),i.propagateChange(i.actions)})).Open();break;case"UrlRewrite":this.actionHelper.GetModal("UrlRewrite").SetData(e).AddEventHandler("OK",(function(n){e.Parameters=n.payload,i.actions=t(i.actions),i.propagateChange(i.actions)})).Open();break;case"Script":this.actionHelper.GetModal("Script").SetData(e).AddEventHandler("OK",(function(n){e.Parameters=n.payload,i.actions=t(i.actions),i.propagateChange(i.actions),n.handle.Close()})).AddEventHandler("Save",(function(n){e.Parameters=n.payload,i.actions=t(i.actions),i.propagateChange(i.actions),i.rulesService.UpdateAction(e).subscribe()})).Open()}}},{key:"propagateChange",value:function(e){this.actionsChange.emit(e),this.registered.forEach((function(t){t(e)}))}},{key:"writeValue",value:function(e){this.actions=e}},{key:"registerOnChange",value:function(e){-1===this.registered.indexOf(e)&&this.registered.push(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){}},{key:"actions",get:function(){return this.actionsSubject$.value},set:function(e){e=null==e?void 0:e.sort((function(e,t){return e.Order>t.Order?1:e.Order<t.Order?-1:0})),this.actionsSubject$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||ht)(p.Nb(h.a),p.Nb(A.b),p.Nb(A.c),p.Nb(p.P),p.Nb(p.h),p.Nb(p.j),p.Nb(ge),p.Nb(R))},ht.\u0275cmp=p.Hb({type:ht,selectors:[["endpoint-actions-list"]],inputs:{actions:"actions"},outputs:{actionsChange:"actionsChange"},features:[p.yb([{provide:N.k,useExisting:ht,multi:!0}])],decls:12,vars:7,consts:[["cdkDropList","",1,"outer",2,"flex-grow","1","height","100%",3,"contextmenu","click"],["nullList","cdkDropList"],["cdkDropList","",2,"padding","2px","margin-top","8px","max-height","calc(100% - 30px)","overflow-y","auto",3,"cdkDropListDropped"],["rulesList","cdkDropList"],["style","text-align: center; font-size: 1.3em; font-weight: bold; color: #525e7678; line-height: 1.4em; line-height: 2em; margin: 0px 10px;",4,"ngIf"],[4,"ngFor","ngForOf"],["outerContextMenu",""],["itemContextMenu",""],[2,"text-align","center","font-size","1.3em","font-weight","bold","color","#525e7678","line-height","1.4em","line-height","2em","margin","0px 10px"],[2,"font-size","1.5em"],["cdkDrag","","cdkDragLockAxis","y"],[1,"action-item",3,"click","dblclick","contextmenu"],[2,"display","flex"],["cdkDragHandle","",1,"dragHandle",2,"padding","10px 0px 0px 5px"],["class","title-icon",4,"ngIf"],[2,"padding","5px","flex-grow","1"],[2,"font-size","large","font-weight","bold","color","#292f3b"],[3,"action"],["class","terminate-indicator","nz-tooltip","",3,"nzTooltipTitle",4,"ngIf"],[4,"ngIf"],[1,"title-icon"],["style","font-size: xx-large; width: 40px; text-align: left;","nz-icon","","nzTheme","outline",3,"nzType",4,"ngIf"],["style","font-size: xx-large; width: 40px; text-align: left;","nz-icon","",3,"icon",4,"ngIf"],["nz-icon","","nzTheme","outline",2,"font-size","xx-large","width","40px","text-align","left",3,"nzType"],["nz-icon","",2,"font-size","xx-large","width","40px","text-align","left",3,"icon"],["nz-tooltip","",1,"terminate-indicator",3,"nzTooltipTitle"],["nzDashed","",1,"action-divider",3,"nzText"],["nz-menu","","nzMode","vertical",1,"context-menu"],["nz-submenu","","nzTitle","Add Action","nzIcon","menu-unfold"],[1,"context-menu"],["nz-menu-item","",3,"click"],["nz-icon","","nzType","rollback","nzTheme","outline"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","code","nzTheme","outline"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-submenu","","nzTitle","Options","nzIcon","setting",4,"ngIf"],["nz-submenu","","nzTitle","Add Action Before","nzIcon","up",4,"ngIf"],["nz-submenu","","nzTitle","Add Action After","nzIcon","down",4,"ngIf"],["nz-menu-divider",""],["nz-icon","","nzType","delete","nzTheme","outline"],["nz-icon","",3,"icon"],["nz-icon","","nzType","form","nzTheme","outline"],["nz-submenu","","nzTitle","Options","nzIcon","setting"],["icon","fa#far|stop-circle"],["icon","fa#far|play-circle"],["nz-submenu","","nzTitle","Add Action Before","nzIcon","up"],["nz-submenu","","nzTitle","Add Action After","nzIcon","down"]],template:function(e,t){if(1&e){var n=p.Ub();p.Tb(0,"div",0,1),p.bc("contextmenu",(function(e){p.wc(n);var i=p.tc(9);return t.OpenOuterContextMenu(e,i)}))("click",(function(){return t.ClickOutside()})),p.Tb(2,"div",2,3),p.bc("cdkDropListDropped",(function(e){return t.drop(e)})),p.Ec(4,Xe,5,0,"div",4),p.fc(5,"async"),p.Ec(6,nt,12,11,"ng-container",5),p.fc(7,"async"),p.Sb(),p.Sb(),p.Ec(8,it,12,0,"ng-template",null,6,p.Fc),p.Ec(10,pt,11,6,"ng-template",null,7,p.Fc)}2&e&&(p.zb(4),p.lc("ngIf",0===(p.gc(5,2,t.actions$)||p.nc(6,gt)).length),p.zb(2),p.lc("ngForOf",p.gc(7,4,t.actions$)))},directives:[O.c,b.o,b.n,O.a,O.b,Je,L.a,F.a,Qe.b,ve.d,qe.a,B.c,B.g,B.e,B.d,me.c],pipes:[b.b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1}.action-item[_ngcontent-%COMP%]{margin-bottom:10px!important;border-radius:0!important;box-shadow:0 0 3px 1px #cecece;background-color:#fff}.action-item.disabled[_ngcontent-%COMP%]{opacity:.6;box-shadow:none;background-color:#e2e2e2}.action-item[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{border-right:1px solid #fff}.action-item[_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:#525e76;color:#fff}.action-item.selected[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{background-color:#292f3b;color:#fff}.action-item[_ngcontent-%COMP%]:hover{background-color:#b2b7c2}.new-rule.ui.button[_ngcontent-%COMP%]{margin:0}.options[_ngcontent-%COMP%]{background-color:grey;height:50px}.list-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background-color:inherit!important}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:hover{background-color:inherit}.dragHandle[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.list-item[_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:#e0e1e2}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dragHandle[_ngcontent-%COMP%]{cursor:inherit}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover   .dragHandle[_ngcontent-%COMP%]{background-color:inherit}.list-item.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%], .new-rule.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%]{border-radius:0!important;background-color:#2f2f2f;color:#f5f5f5}.outer.cdk-drop-list-dragging[_ngcontent-%COMP%] > .new-rule.cdk-drag.cdk-drag-placeholder[_ngcontent-%COMP%]{display:none}.context-menu[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:0!important}.afterTerminate[_ngcontent-%COMP%]{opacity:.3}.terminate-indicator[_ngcontent-%COMP%]{width:8px;background-color:#525e76;border-left:1px solid #fff}.action-item.disabled[_ngcontent-%COMP%]   .terminate-indicator[_ngcontent-%COMP%]{background-color:inherit}.action-item[_ngcontent-%COMP%]:hover   .terminate-indicator[_ngcontent-%COMP%]{background-color:#525e76;color:#fff}"],changeDetection:0}),ht);function vt(e,t){1&e&&(p.Ob(0,"i",32),p.Gc(1,"Basic "))}function St(e,t){1&e&&(p.Tb(0,"span"),p.Gc(1,"Enabled"),p.Sb())}function Ot(e,t){1&e&&(p.Tb(0,"span"),p.Gc(1,"Disabled"),p.Sb())}function yt(e,t){1&e&&(p.Ob(0,"i",33),p.Gc(1,"Actions"))}function xt(e,t){1&e&&(p.Ob(0,"i",36),p.Gc(1,"Debug"))}function kt(e,t){if(1&e&&(p.Tb(0,"nz-tab",3),p.Ec(1,xt,2,0,"ng-template",null,34,p.Fc),p.Tb(3,"div",35),p.Tb(4,"pre"),p.Gc(5),p.fc(6,"json"),p.Sb(),p.Sb(),p.Sb()),2&e){var n=p.tc(2),i=p.ec(2);p.lc("nzTitle",n),p.zb(5),p.Hc(p.gc(6,2,i.form.value))}}var Tt=function(){return{inkBar:!0,tabPane:!1}},zt=function(){return[","]};function Ct(e,t){if(1&e){var n=p.Ub();p.Rb(0),p.Tb(1,"form",1),p.Tb(2,"nz-tabset",2),p.bc("nzSelectChange",(function(e){return p.wc(n),p.ec().tabChanged(e)})),p.Tb(3,"nz-tab",3),p.Ec(4,vt,2,0,"ng-template",null,4,p.Fc),p.Tb(6,"div",5),p.Tb(7,"div",6),p.Tb(8,"nz-form-label",7),p.Gc(9,"Name"),p.Sb(),p.Tb(10,"nz-form-control"),p.Ob(11,"input",8),p.Sb(),p.Tb(12,"nz-form-label",9),p.Gc(13,"Path"),p.Sb(),p.Tb(14,"nz-form-control"),p.Ob(15,"input",10),p.Sb(),p.Tb(16,"nz-form-label",11),p.Gc(17,"Hostname"),p.Sb(),p.Tb(18,"nz-form-control"),p.Ob(19,"input",12),p.Sb(),p.Sb(),p.Ob(20,"div",13),p.Tb(21,"div",14),p.Tb(22,"nz-collapse",15),p.Tb(23,"nz-collapse-panel",16),p.Tb(24,"label",17),p.Ec(25,St,2,0,"span",0),p.Ec(26,Ot,2,0,"span",0),p.Sb(),p.Sb(),p.Tb(27,"nz-collapse-panel",18),p.Tb(28,"nz-select",19),p.Ob(29,"nz-option",20),p.Ob(30,"nz-option",21),p.Sb(),p.Sb(),p.Tb(31,"nz-collapse-panel",22),p.Tb(32,"nz-form-control"),p.Tb(33,"nz-select",23),p.Ob(34,"nz-option",24),p.Ob(35,"nz-option",25),p.Ob(36,"nz-option",26),p.Ob(37,"nz-option",27),p.Ob(38,"nz-option",28),p.Sb(),p.Sb(),p.Sb(),p.Sb(),p.Sb(),p.Sb(),p.Sb(),p.Tb(39,"nz-tab",3),p.Ec(40,yt,2,0,"ng-template",null,29,p.Fc),p.Ob(42,"endpoint-actions-list",30),p.Sb(),p.Ec(43,kt,7,4,"nz-tab",31),p.fc(44,"async"),p.Sb(),p.Sb(),p.Qb()}if(2&e){var i=p.tc(5),o=p.tc(41),r=p.ec();p.zb(1),p.lc("formGroup",r.form),p.zb(1),p.lc("nzAnimated",p.nc(12,Tt)),p.zb(1),p.lc("nzTitle",i),p.zb(19),p.lc("nzBordered",!0),p.zb(1),p.lc("nzActive",!0),p.zb(2),p.lc("ngIf",!!r.form.value.Enabled),p.zb(1),p.lc("ngIf",!r.form.value.Enabled),p.zb(7),p.lc("nzTokenSeparators",p.nc(13,zt)),p.zb(6),p.lc("nzTitle",o),p.zb(4),p.lc("ngIf",p.gc(44,10,r.showDebugInformations$))}}var wt,It,Mt,Pt=[{path:"",component:Ge},{path:":id",component:(wt=function(){function t(n,i,o,r){var c=this;d(this,t),this.uiService=n,this.route=i,this.rulesService=o,this.fb=r,this.rule$=Object(Ee.a)([this.route.paramMap,this.route.queryParamMap,this.route.fragment]).pipe(Object(k.a)((function(t){var n=e(t,3),i=n[0];return n[1],n[2],c.Id=i.get("id"),c.rulesService.GetRule(c.Id)})),Object(Ne.a)(),Object(k.a)((function(e){return e.Actions=e.Actions.sort((function(e,t){return e.Order-t.Order})),e})),Object(m.a)((function(e){c.BaseRule||(c.BaseRule=e),c.uiService.Set((function(t){t.Header.Title="Endpoint Rule",t.Header.SubTitle=e.Name,t.Header.Icon="form",t.Footer.Button1.Visible=!0,t.Footer.Button2.Visible=!0})),c.form.patchValue(e)}))),this.showDebugInformations$=this.uiService.showDebugInformations$,this.selectedTab=new v.a(0),this.uiService.Set((function(e){e.Footer.Button1.Disabled=!0,e.Footer.Button2.Disabled=!0,e.Footer.Button1.OnClick=function(){c.save()},e.Footer.Button2.Text="Reset",e.Footer.Button2.OnClick=function(){c.form.reset(c.BaseRule)},e.Footer.Show=!0})),this.form=this.fb.group({Id:[null],Name:[null,N.q.required],Scheme:[],Hostname:[],Path:[],Actions:[[]],HttpMethods:[[]],Order:[],Enabled:[!1]})}return s(t,[{key:"ngOnInit",value:function(){var e=this;this.form.get("Name").valueChanges.subscribe((function(t){return e.uiService.Set((function(e){return e.Header.SubTitle=t}))})),this.form.valueChanges.subscribe((function(t){e.form.valid?e.SetButtonStatus(t):e.uiService.Set((function(e){e.Footer.Button1.Disabled=!0,e.Footer.Button1.Text="Form not valid!"}))}))}},{key:"GeneratePatchDocument",value:function(e,t){return t=null!=t?t:this.form.value,(e=null!=e?e:this.BaseRule).Permissions=null,t.Permissions=null,Object(He.a)(e,t)}},{key:"save",value:function(){var e,t=this,n=this.form.value;null===(e=n.Actions)||void 0===e||e.forEach((function(e){var t,n=/^(\-|\+)?([0-9]+|Infinity)$/.test(t=e.Id)?Number(t):NaN;Number.isNaN(n)||(e.Id=null)})),console.log(n),this.rulesService.Update(this.Id,n).pipe(Object(m.a)((function(){t.BaseRule=t.form.value,t.SetButtonStatus(t.BaseRule)}))).subscribe()}},{key:"SetButtonStatus",value:function(e){var t=this.GeneratePatchDocument(this.BaseRule,e);this.uiService.Set(t.length>0?function(e){e.Footer.Button1.Disabled=!1,e.Footer.Button1.Text="Save Changes",e.Footer.Button2.Disabled=!1}:function(e){e.Footer.Button1.Disabled=!0,e.Footer.Button1.Text="No Changes",e.Footer.Button2.Disabled=!0})}},{key:"tabChanged",value:function(e){var t;this.selectedTab.next(null!==(t=e.index)&&void 0!==t?t:0)}},{key:"isNotSelected",value:function(e){return-1===this.form.value.HttpMethods.indexOf(e)}},{key:"BaseRule",set:function(e){this._baseRule=JSON.parse(JSON.stringify(e))},get:function(){return this._baseRule}}]),t}(),wt.\u0275fac=function(e){return new(e||wt)(p.Nb(h.a),p.Nb(f.a),p.Nb(R),p.Nb(N.e))},wt.\u0275cmp=p.Hb({type:wt,selectors:[["endpoint-rule-details"]],decls:2,vars:3,consts:[[4,"ngIf"],["nz-form","",2,"flex-grow","1","display","flex","flex-direction","column","overflow","hidden",3,"formGroup"],[3,"nzAnimated","nzSelectChange"],[3,"nzTitle"],["BasicTitle",""],[2,"display","flex","flex-direction","row","padding","3px"],[2,"flex-grow","1"],["nzRequired","","nzFor","Name"],["nz-input","","formControlName","Name","id","Name",2,"width","100%"],["nzRequired","","nzFor","Path"],["nz-input","","formControlName","Path","id","Path",2,"width","100%"],["nzFor","Hostname"],["nz-input","","formControlName","Hostname","id","Hostname","placeHolder","*",2,"width","100%"],[2,"width","10px","margin-right","10px"],[2,"width","30%"],["nzAccordion","",3,"nzBordered"],["nzHeader","Options",3,"nzActive"],["nz-checkbox","","formControlName","Enabled"],["nzHeader","Schemes"],["nzMode","multiple","nzPlaceHolder","all Schemes allowed","formControlName","Scheme","nzMode","tags",2,"width","100%"],["nzLabel","Http","nzValue","http"],["nzLabel","Https","nzValue","https"],["nzHeader","Http Methods"],["nzMode","multiple","nzPlaceHolder","all Methods allowed","formControlName","HttpMethods","nzMode","tags",2,"width","100%",3,"nzTokenSeparators"],["nzLabel","Get","nzValue","Get"],["nzLabel","Post","nzValue","Post"],["nzLabel","Put","nzValue","Put"],["nzLabel","Delete","nzValue","Delete"],["nzLabel","Patch","nzValue","Patch"],["ActionsTitle",""],["formControlName","Actions"],[3,"nzTitle",4,"ngIf"],["nz-icon","","nzType","container"],["nz-icon","","nzType","ordered-list"],["DebugTitle",""],[2,"height","100%"],["nz-icon","","nzType","bug"]],template:function(e,t){1&e&&(p.Ec(0,Ct,45,14,"ng-container",0),p.fc(1,"async")),2&e&&p.lc("ngIf",p.gc(1,1,t.rule$))},directives:[b.o,N.r,N.n,q.b,N.h,De.c,De.a,X.a,q.d,q.a,W.b,N.d,N.m,N.g,Ue.a,Ue.c,ie.a,ue.b,ue.a,mt,L.a,F.a],pipes:[b.b,b.i],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}"]}),wt)}],Rt=((It=function e(){d(this,e)}).\u0275mod=p.Lb({type:It}),It.\u0275inj=p.Kb({factory:function(e){return new(e||It)},imports:[[f.l.forChild(Pt)],f.l]}),It),At=r("YPwk"),_t=((Mt=function e(){d(this,e)}).\u0275mod=p.Lb({type:Mt}),Mt.\u0275inj=p.Kb({factory:function(e){return new(e||Mt)},imports:[[b.c,N.p,Rt,O.d,At.a]]}),Mt)}}])}();